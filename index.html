<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Giveaway Account - Blox Fruit</title>
<style>
  :root{
    --bg-dark:#0f1720;
    --card-dark:rgba(255,255,255,0.03);
    --muted-dark:#9aa3ad;
    --accent:#22c55e;
    --text-light:#0b1220;
    --accent-2:#06b6d4;
  }
  html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Arial, sans-serif;}
  body{
    background: linear-gradient(180deg,var(--bg-dark), #0b1220);
    color:#e6eef4;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:22px;
    transition:background .2s,color .2s;
  }

  .wrap{ width:100%; max-width:1000px; display:grid; grid-template-columns:1fr 380px; gap:18px; align-items:start;}
  .card{ background:var(--card-dark); border-radius:12px; padding:18px; box-shadow:0 8px 40px rgba(2,6,23,0.6); }

  /* Left column */
  .title{ font-size:18px; font-weight:800; margin:0 0 6px; color:#fff; }
  .lead{ color:rgba(255,255,255,0.75); margin:0 0 12px; font-size:13px; }

  .form { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .form input[type="text"]{
    flex:1; min-width:220px; padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.04);
    background: rgba(255,255,255,0.02); color:#fff; font-size:15px; outline:none;
  }
  .btn {
    padding:10px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:800; color:#072010;
    background:var(--accent);
  }
  .btn.secondary { background:transparent; color:var(--muted-dark); border:1px solid rgba(255,255,255,0.04); }

  .result { margin-top:16px; display:none; gap:12px; padding:12px; border-radius:10px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); align-items:center; }
  .meta { flex:1; }
  .row{ display:flex; align-items:center; gap:8px; justify-content:space-between; margin:6px 0; font-size:15px; color:#fff; }
  .label{ color:rgba(255,255,255,0.75); font-size:13px; min-width:80px; }
  .value{ font-weight:800; word-break:break-all; color:#fff; }

  .copy-btn { padding:6px 8px; border-radius:8px; background:rgba(255,255,255,0.06); border:none; color:#fff; font-weight:800; cursor:pointer; }

  /* loader */
  .loader{ width:36px; height:36px; border-radius:50%; border:4px solid rgba(255,255,255,0.06); border-top-color:var(--accent); animation:spin 1s linear infinite; margin:12px auto; display:none; }
  @keyframes spin{ to{ transform:rotate(360deg);} }

  /* Right column */
  .right { width:100%; max-width:380px; display:flex; flex-direction:column; gap:12px; }
  .history .controls { display:flex; gap:8px; margin-bottom:8px; }
  .history input[type="search"]{ flex:1; padding:9px 10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:rgba(255,255,255,0.02); color:#fff; }
  .history ul{ list-style:none; padding:0; margin:0; max-height:420px; overflow:auto; }
  .history li{ background: rgba(255,255,255,0.03); margin:6px 0; padding:9px; border-radius:8px; color:#fff; font-size:13px; display:flex; justify-content:space-between; align-items:center; gap:8px; }
  .history .small{ color:rgba(255,255,255,0.65); font-size:12px; margin-top:6px; }

  .footer{ margin-top:18px; font-weight:800; color:#ffd54a; text-align:center; }

  /* Light mode */
  body.light{ background: linear-gradient(180deg,#f3f6f8,#e9f0f6); color:var(--text-light); }
  body.light .card{ background: var(--card-light); color:var(--text-light); box-shadow:0 10px 30px rgba(2,6,23,0.06);}
  body.light .form input, body.light .history input[type="search"]{ background:#fff; color:var(--text-light); border:1px solid #e6eef4; }
  body.light .result, body.light .history li{ background:#fff; color:var(--text-light); border:1px solid #f0f0f0; }
  body.light .copy-btn{ background:#eef2ff; color:#1e3a8a; }

  /* toast */
  .toast{ position:fixed; right:18px; top:18px; background:#0b1220; color:#fff; padding:10px 14px; border-radius:10px; display:none; z-index:9999; }
  .toast.show{ display:block; }

  @media (max-width:920px){
    .wrap{ grid-template-columns: 1fr; }
    .right{ order:-1; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- LEFT -->
    <div class="card left">
      <div class="title">üéÅ Nh·∫≠p m√£ nh·∫≠n t√†i kho·∫£n</div>
      <div class="lead">Nh·∫≠p m√£ d·∫°ng <code>HOANGLAM_xxxx</code> (kh√¥ng ph√¢n bi·ªát hoa/th∆∞·ªùng).</div>

      <div class="form" role="form" aria-label="Form nh·∫≠p m√£">
        <input id="codeInput" type="text" placeholder="VD: HOANGLAM_3392ijdju2ns" aria-label="Input m√£">
        <button class="btn" id="redeemBtn">Nh·∫≠n ngay</button>
        <button class="btn secondary" id="themeBtn" title="ƒê·ªïi giao di·ªán">ƒê·ªïi giao di·ªán</button>
      </div>

      <div id="loader" class="loader" aria-hidden="true"></div>

      <div id="resultBox" class="result" aria-live="polite" role="status">
        <div class="meta">
          <div class="row">
            <div><span class="label">Username</span></div>
            <div style="display:flex;gap:8px;align-items:center">
              <div class="value" id="usernameVal">‚Äî</div>
              <button class="copy-btn" id="copyUserBtn" title="Copy username">COPY</button>
            </div>
          </div>

          <div class="row">
            <div><span class="label">Password</span></div>
            <div style="display:flex;gap:8px;align-items:center">
              <div class="value" id="passwordVal" data-hidden="true">‚Äî</div>
              <button class="copy-btn" id="togglePassBtn" title="Hi·ªán/·∫®n m·∫≠t kh·∫©u">üëÅ</button>
              <button class="copy-btn" id="copyPassBtn" title="Copy password">COPY</button>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- RIGHT -->
    <div class="card small right">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <strong style="font-size:15px">L·ªãch s·ª≠ ƒë√£ nh·∫≠n</strong>
        <div style="display:flex;gap:8px">
          <button class="copy-btn" id="exportBtn" title="T·∫£i l·ªãch s·ª≠ (.txt)">T·∫¢I TXT</button>
          <button class="copy-btn" id="clearBtn" title="X√≥a l·ªãch s·ª≠" style="background:#ff6b6b">X√ìA</button>
        </div>
      </div>

      <div class="history">
        <div class="controls">
          <input type="search" id="searchHistory" placeholder="T√¨m trong l·ªãch s·ª≠..." aria-label="T√¨m l·ªãch s·ª≠">
        </div>
        <ul id="historyList" aria-live="polite"></ul>
        <div class="small">L·ªãch s·ª≠ l∆∞u tr√™n tr√¨nh duy·ªát (ƒë·ªìng b·ªô gi·ªØa c√°c tab).</div>
      </div>
    </div>
  </div>

  <div class="footer">‚ú® Website ƒë∆∞·ª£c l√†m b·ªüi Phan Ho√†ng L√¢m ‚ú®</div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
/* ---------------- CONFIG: m√£ ‚Üí account ---------------- */
const ACCOUNTS = {
  "HOANGLAM_3392ijdju2ns": { username: "MariotClot", password: "NAMHA123" },
  "HOANGLAM_a7k3m9zq":     { username: "LaiT1445",   password: "NAMHA123" },
  "HOANGLAM_q8z2p5lm":     { username: "MaMaimn2",   password: "NAMHA123" },
  "HOANGLAM_r4t6w1bx":     { username: "MaMaBay321", password: "NAMHA123" },
  "HOANGLAM_yu72bf9k":     { username: "KatuRuler9x",password: "NAMHA123" },
  "HOANGLAM_12xk9vrc":     { username: "Coconutne89",password: "NAMHA123" }
};

/* ---------------- DOM ---------------- */
const codeInput = document.getElementById('codeInput');
const redeemBtn = document.getElementById('redeemBtn');
const themeBtn = document.getElementById('themeBtn');
const loader = document.getElementById('loader');
const resultBox = document.getElementById('resultBox');
const usernameVal = document.getElementById('usernameVal');
const passwordVal = document.getElementById('passwordVal');
const copyUserBtn = document.getElementById('copyUserBtn');
const copyPassBtn = document.getElementById('copyPassBtn');
const togglePassBtn = document.getElementById('togglePassBtn');
const historyList = document.getElementById('historyList');
const exportBtn = document.getElementById('exportBtn');
const clearBtn = document.getElementById('clearBtn');
const searchHistory = document.getElementById('searchHistory');
const toast = document.getElementById('toast');

/* ---------------- Storage keys ---------------- */
const HISTORY_KEY = 'giveaway_history_v1';
const THEME_KEY = 'giveaway_theme_v1';

/* ---------------- Utils ---------------- */
function showToast(txt, ms=1400){
  toast.textContent = txt;
  toast.classList.add('show');
  toast.style.display = 'block';
  clearTimeout(toast._t);
  toast._t = setTimeout(()=>{ toast.style.display='none'; }, ms);
}
function toKey(s){ return String(s||'').trim().toUpperCase(); }

/* ---------------- History persistence & sync ---------------- */
function loadHistory(){
  try{
    const raw = localStorage.getItem(HISTORY_KEY);
    return raw ? JSON.parse(raw) : [];
  }catch(e){ return []; }
}
function saveHistory(arr){
  try{ localStorage.setItem(HISTORY_KEY, JSON.stringify(arr)); }catch(e){}
}
function pushHistory(entry){
  const arr = loadHistory();
  arr.unshift(entry);
  if(arr.length>200) arr.length = 200; // cap
  saveHistory(arr);
  renderHistory();
  // notify other tabs (storage event will fire automatically)
}
function clearHistory(){
  saveHistory([]);
  renderHistory();
}

/* render history list */
function renderHistory(){
  const arr = loadHistory();
  historyList.innerHTML = '';
  if(arr.length === 0){
    historyList.innerHTML = '<li style="opacity:.6">Ch∆∞a c√≥ l·ªãch s·ª≠</li>';
    return;
  }
  arr.forEach(it=>{
    const li = document.createElement('li');
    const left = document.createElement('div');
    left.style.flex = '1';
    left.style.minWidth = '0';
    left.textContent = `${it.time} ‚Äî ${it.code} ‚Üí ${it.username} / ${maskPwd(it.password)}`;
    // show/hide password per item: small button
    const right = document.createElement('div');
    right.style.display = 'flex';
    right.style.gap = '8px';
    const showBtn = document.createElement('button');
    showBtn.className = 'copy-btn';
    showBtn.textContent = 'HI·ªÜN';
    showBtn.onclick = ()=> {
      if(showBtn.textContent === 'HI·ªÜN'){ left.textContent = `${it.time} ‚Äî ${it.code} ‚Üí ${it.username} / ${it.password}`; showBtn.textContent='·∫®N'; }
      else { left.textContent = `${it.time} ‚Äî ${it.code} ‚Üí ${it.username} / ${maskPwd(it.password)}`; showBtn.textContent='HI·ªÜN'; }
    };
    const copyBtn = document.createElement('button');
    copyBtn.className = 'copy-btn';
    copyBtn.textContent = 'COPY';
    copyBtn.onclick = ()=> { copyToClipboard(`${it.username}\t${it.password}`); showToast('ƒê√£ copy username & password'); };
    right.appendChild(showBtn);
    right.appendChild(copyBtn);
    li.appendChild(left);
    li.appendChild(right);
    historyList.appendChild(li);
  });
}

/* mask password for display */
function maskPwd(p){
  if(!p) return '‚Äî';
  return '*'.repeat(Math.min(4, p.length)) + (p.length>4 ? '...' : '');
}

/* copy helper */
async function copyToClipboard(text){
  try{
    await navigator.clipboard.writeText(text);
    return true;
  }catch(e){
    // fallback
    const ta = document.createElement('textarea');
    ta.value = text; document.body.appendChild(ta); ta.select();
    try{ document.execCommand('copy'); ta.remove(); return true;}catch(e2){ ta.remove(); return false;}
  }
}

/* ---------------- Theme (persist & sync) ---------------- */
function loadTheme(){
  return localStorage.getItem(THEME_KEY) === 'light';
}
function saveTheme(isLight){
  localStorage.setItem(THEME_KEY, isLight ? 'light' : 'dark');
}
function applyTheme(){
  const isLight = loadTheme();
  document.body.classList.toggle('light', isLight);
}
/* apply on load */
applyTheme();

/* ---------------- Redeem logic with loading ---------------- */
function redeem(){
  const raw = codeInput.value;
  const key = toKey(raw);
  if(!key){ showToast('Vui l√≤ng nh·∫≠p m√£'); return; }

  // show loader
  resultBox.style.display = 'none';
  loader.style.display = 'block';

  // simulate check delay (1s)
  setTimeout(()=>{
    loader.style.display = 'none';
    // find matching ACCOUNTS key (case-insensitive)
    const matched = Object.keys(ACCOUNTS).find(k => toKey(k) === key);
    if(!matched){
      resultBox.style.display = 'flex';
      usernameVal.textContent = '‚Äî';
      passwordVal.textContent = '‚Äî';
      showToast('M√£ kh√¥ng h·ª£p l·ªá', 1200);
      return;
    }
    const acc = ACCOUNTS[matched];
    usernameVal.textContent = acc.username;
    passwordVal.textContent = acc.password;
    passwordVal.dataset.hidden = 'false'; // default visible in result for easy copy (you can toggle)
    resultBox.style.display = 'flex';

    // add to history with timestamp
    const now = new Date();
    const entry = {
      time: now.toLocaleString(),
      code: matched,
      username: acc.username,
      password: acc.password
    };
    pushHistory(entry);
    showToast('Th√¥ng tin hi·ªÉn th·ªã');
  }, 900);
}

/* ---------------- Copy / toggle password in result ---------------- */
copyUserBtn.addEventListener('click', async ()=> {
  if(usernameVal.textContent && usernameVal.textContent !== '‚Äî'){ await copyToClipboard(usernameVal.textContent); showToast('ƒê√£ copy username'); }
});
copyPassBtn.addEventListener('click', async ()=> {
  if(passwordVal.textContent && passwordVal.textContent !== '‚Äî'){ await copyToClipboard(passwordVal.textContent); showToast('ƒê√£ copy password'); }
});
togglePassBtn.addEventListener('click', ()=>{
  if(passwordVal.dataset.hidden === 'true' || passwordVal.dataset.hidden === undefined){
    // show
    passwordVal.textContent = passwordVal.dataset || passwordVal.textContent; // ensure
    // keep actual value stored in dataset? we will set dataset.pass when redeem
    if(passwordVal.dataset.pass) passwordVal.textContent = passwordVal.dataset.pass;
    passwordVal.dataset.hidden = 'false';
  } else {
    // hide
    const p = passwordVal.dataset.pass || passwordVal.textContent;
    passwordVal.dataset.pass = p;
    passwordVal.textContent = '*'.repeat(Math.min(6,p.length));
    passwordVal.dataset.hidden = 'true';
  }
});

/* ensure dataset.pass set upon result show; hook inside redeem -> after setting passwordVal.textContent set dataset.pass */
(function hookResultDataset(){
  // when redeem sets passwordVal.textContent directly, we want dataset.pass to be set.
  // So override redeem's assignment? Simpler: after renderHistory and redeem, we set dataset.pass.
})();

/* ---------------- Export TXT ---------------- */
function exportTxt(){
  const arr = loadHistory();
  if(arr.length === 0){ showToast('Kh√¥ng c√≥ l·ªãch s·ª≠ ƒë·ªÉ t·∫£i'); return; }
  // prepare lines: "time ‚Äî code ‚Äî username / password"
  const lines = arr.map(it => `${it.time} ‚Äî ${it.code} ‚Äî ${it.username} / ${it.password}`);
  const content = lines.join('\n');
  const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'accounthoanglam.txt';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
  showToast('B·∫Øt ƒë·∫ßu t·∫£i accounthoanglam.txt');
}

/* ---------------- Clear history ---------------- */
clearBtn.addEventListener('click', ()=>{
  if(!confirm('X√≥a to√†n b·ªô l·ªãch s·ª≠?')) return;
  clearHistory();
  // notify other tabs via storage event by setting key to empty
  localStorage.setItem(HISTORY_KEY, JSON.stringify([]));
  showToast('ƒê√£ x√≥a l·ªãch s·ª≠');
});

/* ---------------- Search filter ---------------- */
searchHistory.addEventListener('input', ()=>{
  const q = (searchHistory.value || '').toLowerCase().trim();
  const lis = historyList.querySelectorAll('li');
  lis.forEach(li => {
    li.style.display = li.textContent.toLowerCase().includes(q) ? '' : 'none';
  });
});

/* ---------------- Theme toggle ---------------- */
themeBtn.addEventListener('click', ()=>{
  const isLight = !loadTheme();
  saveTheme(isLight);
  applyTheme();
  // broadcast to other tabs simply by updating key (storage event triggers everywhere except origin)
  localStorage.setItem(THEME_KEY, isLight ? 'light' : 'dark');
});

/* ---------------- Export button ---------------- */
exportBtn.addEventListener('click', exportTxt);

/* ---------------- Redeem button and Enter key ---------------- */
redeemBtn.addEventListener('click', redeem);
codeInput.addEventListener('keydown', (e)=> { if(e.key === 'Enter') redeem(); });

/* ---------------- Sync across tabs: listen to storage events ---------------- */
window.addEventListener('storage', (ev) => {
  if(ev.key === HISTORY_KEY){
    renderHistory();
  }
  if(ev.key === THEME_KEY){
    applyTheme();
  }
});

/* ---------------- On load: render history & apply theme ---------------- */
renderHistory();
applyTheme();

/* ---------------- Ensure password dataset when result shows ---------------- */
/* We set dataset.pass when redeem sets passwordVal */
const origRedeem = redeem;
redeem = function(){
  const raw = codeInput.value;
  const key = toKey(raw);
  if(!key){ showToast('Vui l√≤ng nh·∫≠p m√£'); return; }
  resultBox.style.display = 'none';
  loader.style.display = 'block';
  setTimeout(()=>{
    loader.style.display = 'none';
    const matched = Object.keys(ACCOUNTS).find(k => toKey(k) === key);
    if(!matched){
      resultBox.style.display = 'flex';
      usernameVal.textContent = '‚Äî';
      passwordVal.textContent = '‚Äî';
      passwordVal.dataset.pass = '';
      passwordVal.dataset.hidden = 'true';
      showToast('M√£ kh√¥ng h·ª£p l·ªá',1200);
      return;
    }
    const acc = ACCOUNTS[matched];
    usernameVal.textContent = acc.username;
    passwordVal.textContent = acc.password;
    passwordVal.dataset.pass = acc.password; // store real password
    passwordVal.dataset.hidden = 'false';
    resultBox.style.display = 'flex';
    // push history
    const now = new Date();
    const entry = { time: now.toLocaleString(), code: matched, username: acc.username, password: acc.password };
    pushHistory(entry);
    showToast('Hi·ªÉn th·ªã th√¥ng tin t√†i kho·∫£n');
  }, 900);
};

/* ---------------- helper: mask initial history & set up dataset values for displayed result ---------------- */
(function init(){
  // ensure history key exists
  if(!localStorage.getItem(HISTORY_KEY)) localStorage.setItem(HISTORY_KEY, JSON.stringify([]));
  // ensure theme key exists
  if(!localStorage.getItem(THEME_KEY)) localStorage.setItem(THEME_KEY, loadTheme() ? 'light' : 'dark');
  renderHistory();
})();
</script>
</body>
</html>
